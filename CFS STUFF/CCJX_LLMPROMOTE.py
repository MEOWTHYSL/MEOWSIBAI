#0 数据预处理--------------------------------------------[只需手动删除垃圾行，如盖章图片等]


#1 VX----------------------------------------------------------------------------------

#首先，我会上传数据文件我希望你能帮我对文件进行以下处理，处理后直接提供下载链接，处理后输出文件名为上传文件名加上processed：
#0.第一行为列名
#1.取消所有数据的合并
#2.删除空行,删除工作表的所有空行
#3.在交易单号这列前插入新的列,此列命名为DH,并令其值等于此公式：="DH"& 交易单号 并且把这个结果扩展到到整个这一列,完成后，删除交易单号这列
#4.在商户单号这列前插入新的列，此列命名为SH,并令其值等于此公式：="SH"& 商户单号 并且把这个结果扩展到到整个这一列，完成后，删除商户单号这列
#5.在金额(元)这列前插入新的三列，分别命名为in,out,other,对第一行开启筛选,对金额(元)这列进行筛选，分别把筛选选项的中收入、支出、其他存入新插入的三列中，对应的值应该是 "金额(元)" 列的数值，而不仅仅是 "收入"、"支出" 和 "其他" 的标签。
#6.完成in，out，other这三列并保存数值后，把金额(元)这列删掉，把收/支/其他这列也删掉
#7.调整各列的顺序，把所有的列按照以下顺序排列:DH,交易时间,交易类型,in,out,other,交易方式,交易对方,SH
#8.开始处理其他上传的文件，如果没有就结束
#9.把所有处理结果合并成一个表，输出结果

#2 ZFB----------------------------------------------------------------------------------

#首先，我会上传数据文件我希望你能帮我对文件进行以下处理，处理后直接提供下载链接，处理后输出文件名为上传文件名加上processed：
#0.创建一行作为首行，用来给所有的列命名，把各列分别命名为：收/支/其他,交易对方,交易类型,交易方式,金额(元),交易单号,商户单号,交易时间
#1.取消所有的单元格合并
#2.删除空行,删除工作表的所有空行
#3.在交易单号这列前插入新的列,此列命名为DH,并令其值等于此公式：="DH"& 交易单号 并且把这个结果扩展到到整个这一列,完成后，删除交易单号这列
#4.在商户单号这列前插入新的列，此列命名为SH,并令其值等于此公式：="SH"& 商户单号 并且把这个结果扩展到到整个这一列，完成后，删除商户单号这列
#5.在金额(元)这列前插入新的三列，分别命名为in,out,other,对第一行开启筛选,对金额(元)这列进行筛选，分别把筛选选项的中收入、支出、其他存入新插入的三列中，对应的值应该是 "金额(元)" 列的数值，而不仅仅是 "收入"、"支出" 和 "其他" 的标签。
#6.完成in，out，other这三列并保存数值后，把金额(元)这列删掉，把收/支/其他这列也删掉
#7.调整各列的顺序，把所有的列按照以下顺序排列:DH,交易时间,交易类型,in,out,other,交易方式,交易对方,SH
#8.开始处理其他上传的文件，如果没有就结束
#9.把所有处理结果合并成一个表，输出结果

#3 合并报表到模版格式----------------------------------------------------------------------------------[手动把#1 #2 结果放在模版里](懒得写code)

#4 敏感金额 敏感对象 删除垃圾值----------------------------------------------------------------------------------

# 分别对excel文件中的两个sheet，也就是微信和支付宝sheet进行处理，并且每个sheet的第三行是列名，处理后直接提供下载链接，处理后输出文件名为上传文件名加上processed：
# 1.检查是否是敏感金额：检查收入金额（元），支出金额（元）这两列是否有与以下数值一样的数值：
# 200,300,400,600,800,1000,1200,1500,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,4500,5000,大于或等于10000的一切数值.
# 如果包含以上数值相同的情况,把是否是敏感金额这一列对应数值改为是,如果不包含，填入否.
# 2.检测是否为敏感交易对方：我们的目标是检查交易对方列中的每个条目是否与下列给定的每个字符串完全相同：
# 驰诚（河南）驾培集团股份有限公司 邓州市驰诚驾校 邓州市驰诚驾驶技术培训学校 邓州市驰诚机动车技术检测有限公司 驰诚机动车技术检测 邓州市鼎信机动车鉴定评估有限公司 邓州市鼎信机动车鉴定评估 鼎信机动车 邓州市驰诚二手车交易市场有限公司 邓州市驰诚二手车交易市场 驰诚二手车 唐鸾 唐鸾 冯邓 王慧如 孟春院 萌盐 春燕 米雪 经年 杨微 家有俩宝 苏亭婷 苏婷婷 张莹 ZhangYing 张龙海 .. 周重阳 畩 胡新 胡新 张珊  刘闯 小刘啊 左玛丽娜 彭晓 天生偏执狂 邓朦 公子邓 买梦薇 VVV 康卯 驰诚集团康卯18736555609 滕文莹 驰诚驾校Ying 丁孟姣 丁孟姣 张勇 熊大 李红霞 彩虹 许建全 Xu629110 王礼英 王礼英13598280998 武铭 wm 宋申 vicky 申露 shenlu921 翟凯 月亮上的蜗牛 张璐 Kalends 贾云璐 ，。 刘姗 澜~姗 杨璐 玖月 陈卓 小棉袄 李攀 李攀17796801073 张震 驰诚老张 张蕾 小雨田 张兆吟 十三 屈志 驰诚屈志18503777272 谭炯 Amazing 习占芳 小赢在智，大赢在德 路永惠 一路通行 曹庭霈 S-共勉 付晓勇 归来仍是少年 刘予湘 潇湘 张东尧 张东尧 孙中峰 ——縫 李尧 邓州市驰诚检测公司13193666566 李莉 冬日阳光 房亚楠 哼哼哈哈 陈一戈 赵蕾 桃子 张景星 景星1873725510 张静 驰诚总校张静15670270366 韩梦艳 水墨年華 许婷 鲁亚林 王红颖  驰诚 鼎信  唐鸾 冯邓 王慧如 孟春院 米雪 杨微 苏亭婷 张莹 张龙海 周重阳 胡新 张珊 刘闯 左玛丽娜 彭晓 邓朦 买梦薇 康卯 滕文莹 丁孟姣 张勇 李红霞 许建全 王礼英 武铭 宋申 申露 翟凯 张璐 贾云璐 刘姗 杨璐 陈卓 李攀 张震 张蕾 张兆吟 屈志 谭炯 习占芳 路永惠 曹庭霈 付晓勇 刘予湘 张东尧 孙中峰 李尧 李莉 房亚楠 陈一戈 赵蕾 张景星 张静 韩梦艳 许婷 鲁亚林 王红颖 李硕 张小丽 杨京阁 腾文颖 
# 如果有,把是否是敏感交易对方这一列对应数值改为是,否则填入否.
#删除收入金额（元），支出金额（元），其他 这三列中的0.
#删除商户单号这列中的SHnan.

#5 收支相同----------------------------------------------------------------------------------
# 是否存在疑似代收代付的检测,主要针对一收一支的初步识别，这步不能完全替代[手动]，因为可能有一些项目是多笔钱构成的的

# 我将上传一个文件，我需要你帮我识别，是否有疑似代收待付款，其中第三行是列名
# 对于每笔收入，查找在5天内是否有与之相等的支出金额。
# 如果找到相等的支出金额，标记 "是否同时有收支记录且收支对象不同" 为 "是"。
# 你可以通过交易时间这一列来识别时间的差异,请注意:交易时间的格式是"YYYY-MM-DDHH:MM:SS"，它在日期和时间之间没有分隔符,不要因为无法识别交易时间导致无法分析出是否疑似代收待付款.
# 如果有，把是否同时有收支记录且收支对象不同这列改为是.
# 请注意，如果有这种情况的话，不仅仅需要把收入金额对应的是否同时有收支记录且收支对象不同这列改为是，也要把支出金融对应的是否同时有收支记录且收支对象不同列也改为 "是"
# 如果在5天内找到与收入金额相等的支出金额，同时将两个记录中的 "是否同时有收支记录且收支对象不同" 列都标记为 "是"。

#6自动VLOOKUP并返回整理后数值脚本----------------------------------------[手动处理目标文件，也就是已复合流水，只需删除垃圾行]-----

# 我将上传两个文件,一个为主文件，一个为目标文件，名为C开头为主文件，D开头为目标文件，其中主文件第三行为列名，目前只需要读取主文件的微信这个sheet.
# 对于目标文件，在第一行前插入一列作为列名，列名分别为 交易时间 交易类型 收入 支出 交易对象 学员姓名 身份证号 SYLY DSDZ 收转一致 学费一致 备注
# 将主文件的学员姓名这列数据变为 =IFNA(VOOKUP(lookup_value,table_array,col_index_num,False)&"","")
# 函数中的lookup_value 为主文件的交易时间这列
# 函数中的table_array 为目标文件中第三行开始的(包括第三行)全部有效区域
# 函数中的col_index_num=6 ，请确认这个数值是否与目标文件的学员姓名列数相同 ，如相同继续执行，不同报错
#  类似的处理主文件身份证号这列
# 将主文件的身份证号这列数据变为 =IFNA(VOOKUP(lookup_value,table_array,col_index_num,False)&"","")
# 函数中的lookup_value 为主文件的交易时间这列
# 函数中的table_array 为目标文件中第三行开始的(包括第三行)全部有效区域
# 函数中的col_index_num=7 ，请确认这个数值是否与目标文件的身份证号列数相同 ，如相同继续执行，不同报错
#  把处理后的身份证号和身份证号两列的数据保存数值，避免下载文件后公式失效导致数据错误，使用pandas和Excel读取器来模拟VLOOKUP操作。使用pandas将结果写回Excel，这个策略可以避免无法得到数值的情况。
#  处理后直接提供下载链接，处理后输出文件名为上传文件名加上processed